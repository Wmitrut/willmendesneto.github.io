<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Micro tunnings with Angular apps - Part 1</title>
  <meta name="description" content="This is my blog, where i talk about technologies" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://willmendesneto.github.io/2015/05/11/micro-tunnings-with-angular-apps-part-1">

  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="cache-control" content="no-store, no-cache, must-revalidate" />
    <meta http-equiv="Pragma" content="no-store, no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE" />
    <meta http-equiv="PRAGMA" content="NO-CACHE" />
    <meta name="domain" content="willmendesneto.github.io" />
    <meta name="url" content="/2015/05/11/micro-tunnings-with-angular-apps-part-1" />

    <meta property="og:type" content="article" />
    <meta property="og:title" content="Micro tunnings with Angular apps - Part 1" />
    <meta property="og:url" content="/2015/05/11/micro-tunnings-with-angular-apps-part-1" />
    <meta property="og:description" content="" />
    <meta property="article:author" content="" />
    <meta property="og:site_name" content="Wilson Mendes - Blog" />
    <meta property="og:image" content="/assets/images/components.jpeg" />
    <meta name="twitter:site" content="@willmendesneto" />
    <meta name="twitter:image" content="/assets/images/components.jpeg" />
    <meta name="twitter:card" content="summary" />
    <meta name="autor" content="Wilson Mendes" />
    <meta name="reply-to" content="willmendesneto@gmail.com">
    <meta name="revisit-after" content="3" />
    <meta name="title" content="Wilson Mendes - Blog">
    <meta name="description" content="This is my blog, where i talk about technologies">
    <meta name="keywords" content="["performance,",, "frontend,",, "angular"]" />
  

  <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Pesquisa no Blog" />

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
<!--  <link rel="stylesheet" href=""> -->
  <!-- <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i"> -->
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800" rel="stylesheet" type="text/css">

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/main.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/mini-preview.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/solarized-dark.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<!-- <a href="http://willmendesneto.github.io" class="logo-readium"><span class="logo" style="background-image: url()"></span></a> -->

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="article-image">
          <div class="post-image-image" style="background-image: url(/assets/images/components.jpeg)">
            Article Image
          </div>
          <div class="post-meta">
            <h1 class="post-title">Micro tunnings with Angular apps - Part 1</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(https://pt.gravatar.com/userimage/20307137/677413a79461cdfd62c8a65143214850.png?size=300)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Wilson Mendes</h4>
              on
              <time datetime="2015-05-11 00:00">11 May 2015</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
            <div style="text-align:center">
              <a href="#topofpage" class="topofpage"><i class="fa fa-angle-down"></i></a>
            </div>
          </div>
        </div>
        
        <section class="post-content">

          <a class="home-button"  href="/">&laquo; Home</a>
          <div class="post-reading">
            Lido a <span class="post-reading-time"></span>
          </div>
          <a name="topofpage"></a>
          <div id="post-content-page">
            <p><a class="page-link" href="/2015/06/28/micro-tunings-em-angular-apps-pt-1/">Read the Brazillian Portuguese version</a></p>

<h2 id="introduction">INTRODUCTION</h2>

<p>Many applications are using angular for frontend and it’s really awesome. But with time and software evolution other aspects about product/service are (more) importants too, such as manutenibility and…performance.</p>

<p>But when you think about performance, what are you remember like (re)solution?</p>

<ul>
  <li>++ machines?</li>
  <li>++ cache?</li>
  <li>++ file minification/compression?</li>
  <li>++ use more async calls?</li>
  <li>++ HTTP2 usage?</li>
</ul>

<blockquote>
  <p>Don’t hide the problem</p>
</blockquote>

<p>Yes, all of these are good ideas, but <strong>doesn’t resolve the core problem</strong>. Why not? All these ideas are <strong>paliatives</strong>, because you never attack the real problem and it will appear again in some moment.</p>

<h2 id="real-time-web---concepts">REAL-TIME WEB - CONCEPTS</h2>

<p>Angular is used for various apps including real time webapps, using websockets and three way data binding with Firebase, for example. But firstly, let’s understand some theorical aspects.</p>

<p>When user access your app and the data are updated in a velocity &lt;= 100 miliseconds: this is real-time. Real-time (for now) don’t exist. What exist is a “brain hack” because your brain can’t proccess all that happens in this time, because this it understood such if all behaviours are happening in real time, passing this idea.</p>

<p>Two-way data binding help in this task, based in more <a href="hollywood principle">hollywood-principle</a> possible.</p>

<blockquote>
  <p>The developers don’t need understand how two-way data binding works in background initially</p>
</blockquote>

<p>Yes, it’s true, but when you have an app with many bindings all tips are welcome, such as:</p>

<h3 id="minimize-bindings-and-watchers"><strong>Minimize bindings and watchers</strong></h3>

<p>Ever that can, minimize bindings and watchers, <code>Object.freeze</code> usage <a href="take a look in jsperf comparison between `Object.freeze`, `Object.seal` and object with default behaviour">jsperf-object-freeze</a></p>

<h3 id="ng-if-instead-ng-show"><strong>ng-if instead ng-show</strong></h3>

<p>Use ng-if instead ng-show when you can, because ng-show manipulate element display, but it already exist in DOM and two-way data binding already active, decreasing performance.</p>

<pre><code class="language-html">&lt;div ng-if="!vm.usingOneTimeBinding"&gt;
  &lt;p&gt;
    Makes more sense
  &lt;/p&gt;
&lt;/div&gt;

&lt;div ng-show="!vm.usingOneTimeBinding"&gt;
  &lt;p&gt;
    Please, avoid this approach
  &lt;/p&gt;
&lt;/div&gt;
</code></pre>

<h3 id="filter--two-way-data-binding--no"><strong>$filter + two-way data binding === no!</strong></h3>

<p>Manipulate data in a once moment and pass the data for template instead $filter’s usage in template;</p>

<pre><code class="language-javascript">...
this.users = [
  {firstName: 'eu', lastName: 'ea'},
  {firstName: 'William', lastName: 'Wallace'}
];
...
</code></pre>
<p>Based in this data, avoid use filter in template…</p>

<pre><code class="language-html">...
&lt;div ng-repeat="item in vm.users"&gt;
  
&lt;/div&gt;
...
</code></pre>
<p>… because the effect in your performance is very considerable…</p>

<p><img src="/assets/images/using-filters-in-template.png" alt="When use filter comparison" /></p>

<p>… instead this manipulate the stream’s data in controller, passing the data in your final format only for render in template. In this example is used <code>.map()</code> javascript function for it.</p>

<pre><code class="language-javascript">...
this.users.map(function(el){
  el.username = el.firstName + ' ' + el.lastName;
});
...
</code></pre>

<pre><code class="language-html">...
&lt;div ng-repeat="item in vm.users"&gt;
  
&lt;/div&gt;
...
</code></pre>

<h3 id="ngrepeat--track-by"><strong>ngRepeat + Track by</strong></h3>

<p>Track by in elements are always welcome! ngRepeat is more fast when tracking something.</p>

<pre><code class="language-html">
&lt;!-- Without track by --&gt;
&lt;div ng-repeat="item in vm.users"&gt;
  
&lt;/div&gt;

&lt;!-- With track by --&gt;
&lt;div ng-repeat="item in vm.users track by $index"&gt;
  
&lt;/div&gt;

</code></pre>

<p>In a simple example with and without <code>ngRepeat + Track by</code> the results are very expressives</p>

<p><img src="/assets/images/ng-repeat-track-by-comparison.png" alt="ngRepeat track by usage comparison" /></p>

<h3 id="one-time-binding-usage"><strong>One-time-binding usage</strong></h3>

<p>Use one-time-binding when you can, your app and your users are grateful for it!</p>

<pre><code class="language-html">&lt;div ng-repeat="item in ::vm.users track by $index" &gt;
  
&lt;/div&gt;

&lt;div ng-if="::vm.users.loggedIn"&gt;
  ...
&lt;/div&gt;

&lt;div ng-class="::{ 'my-awesome-class': vm.users.loggedIn}"&gt;
  ...
&lt;/div&gt;
</code></pre>

<h3 id="use-async-patterns">Use async patterns</h3>

<p>In all javascript apps, ever use async patterns for help your life. In angular apps patterns like debounce are very easier to implement and add because <code>ngModelOptions</code> directive. This directive enable async patterns in components in a powerful way.</p>

<p>Debounce is a pattern for how many times the event/method will be called in your application. A example of your usage is a simple search in a list.</p>

<pre><code class="language-html">&lt;form autocomplete="off" role="form"&gt;
  &lt;div class="form-group"&gt;
    &lt;fieldset&gt;
      &lt;input type="search" name="search" id="search" placeholder="Search..." ng-model="vm.searchItem" class="form-control" /&gt;
    &lt;/fieldset&gt;
  &lt;/div&gt;
&lt;/form&gt;
&lt;ul&gt;
  &lt;li ng-repeat="item in vm.users | myFilter:vm.searchItem"&gt;
    
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>In this example the search will be called each user add character in input for search. But this isn’t a good idea. So let’t take a look in debounce usage.</p>

<pre><code class="language-javascript">...
this.myModelOptions = {
  updateOn: 'keydown blur',
  debounce: {
      keydown: 250, //for search we don't want to update server during user type
      blur: 250 //when user move on to the next field, we update immedately
  }
};
...
</code></pre>

<pre><code class="language-html">&lt;form autocomplete="off" role="form"&gt;
  &lt;div class="form-group"&gt;
    &lt;fieldset&gt;
      &lt;input type="search" name="search" id="search" placeholder="Search..." ng-model="vm.searchItem" class="form-control" ng-model-options="vm.myModelOptions" /&gt;
    &lt;/fieldset&gt;
  &lt;/div&gt;
&lt;/form&gt;
&lt;ul&gt;
  &lt;li ng-repeat="item in vm.users | myFilter:vm.searchItem"&gt;
    
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<p>This way the search method/event is dispatched only after 250 miliseconds when triggered via keydown or blur events. The number, based in 3 characters are inserted for search is this.</p>

<p><img src="/assets/images/debounce-comparison.png" alt="With and Without Debounce usage comparison" /></p>

<p>For memoization pattern you can use <code>$provide.decorator()</code> approach, modifying default behaviour of angular, improving and enable cache by default or other possibilities, for example.</p>

<pre><code class="language-javascript">// Creating a new module for enable cache by default
angular.module('perf.rootScope', [])
  // $rootScope modified
  .decorate('$rootScope', function($delegate){
    $delegate.__proto__.$watch = function() {
      ...
    };

    $delegate.__proto__.$apply = function() {
      ...
    };

    return $delegate;
  });

...
angular.module('myApp', 'perf.rootScope']);
</code></pre>

<h2 id="conclusion">CONCLUSION</h2>

<p>In this first post, was approached the Real-time concept and some simple aspects about microtunnings, such best practices about angular core components, javascript optimizations, functional and async patterns usage. In next step the target are concepts about immutable data structure, how to use in app, libraries for help in this work.</p>

<p>Do you use other methods? Comment and share your experience here.</p>

<p>Thanks and see you very soon!</p>

<p>Links:</p>

<ul>
  <li>Hollywood Principle: <a href="http://en.wikipedia.org/wiki/Hollywood_principle">http://en.wikipedia.org/wiki/Hollywood_principle</a></li>
  <li>JsPerf comparison: Object.freeze, Object.seal and object with default behaviour: <a href="http://jsperf.com/freeze-vs-seal-vs-normal/19">http://jsperf.com/freeze-vs-seal-vs-normal/19</a></li>
</ul>


          </div>
        </section>

        
          <section class="newsletter-content">
    <form action="http://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=willmendesneto', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true;" >
        <h3 class="newsletter-title">Receive news by email</h3>
        <p class="newsletter-text">Subscribe to my newsletter to receive notifications of new articles in your e- mail</p>
        <input class="input-newsletter" type="email" name="email" placeholder="email"/>
        <input type="hidden" value="willmendesneto" name="uri"/>
        <input type="hidden" name="loc" value="en_US"/>
        <input class="btn btn-newsletter" type="submit" value="Subscribe" />
    </form>
</section>

        

        <footer class="post-footer">

          <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
  <a class="addthis_button_preferred_1"></a>
  <a class="addthis_button_preferred_2"></a>
  <a class="addthis_button_preferred_3"></a>
  <a class="addthis_button_preferred_4"></a>
  <a class="addthis_button_preferred_5"></a>
</div>


          <!-- <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Micro+tunnings+with+Angular+apps+-+Part+1&amp;url=http://willmendesneto.github.io/2015/05/11/micro-tunnings-with-angular-apps-part-1"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
                <a class="icon-facebook" href="//www.facebook.com/sharer.php?t=Micro+tunnings+with+Angular+apps+-+Part+1&amp;u=http://willmendesneto.github.io/2015/05/11/micro-tunnings-with-angular-apps-part-1"
                  onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                </a>
              
            
              
            
              
                <a class="icon-google-plus" href="https://plus.google.com/share?t=Micro+tunnings+with+Angular+apps+-+Part+1&amp;url=http://willmendesneto.github.io/2015/05/11/micro-tunnings-with-angular-apps-part-1"
                  onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
                <i class="fa fa-google-plus"></i><span class="hidden">google-plus</span>
                </a>
              
            
          </section> -->
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <section class="author">
              <div class="author-image" style="background-image: url(https://pt.gravatar.com/userimage/20307137/677413a79461cdfd62c8a65143214850.png?size=300)">Blog Logo</div>
              <h4>Wilson Mendes</h4>
              
                <p class="bio">Google Developer Expert (GDE) AngularJS and GDG Salvador Organizer. Musician and designer in his spare time.</p>
              
              <hr>
              <p class="published">Publicado em <time datetime="2015-05-11 00:00">11 May 2015</time></p>
            </section>
            <footer class="site-footer">
              <section class="poweredby">Mais um blog feito com <a href="http://jekyllrb.com">Jekyll</a></section>
              <a class="subscribe" href="/feed.xml" target="_blank"> <span class="tooltip"> <i class="fa fa-rss"></i> Assine o feed.</span></a>
            </footer>
          </div>
          
        </div>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'willmendesnetogithubio'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */

        'use strict';

        function load() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

          // Remove o evento
          window.onscroll = function() {};
        }

        window.onscroll = function() {
          if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 2000)) {
            load();
          }
        };
        </script>

        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </article>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/background-1.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Wilson Mendes - Blog</h1>
        <h2 class="blog-description">This is my blog, where i talk about technologies</h2>
        <a href="/" class="btn">Back to Home</a>
      </div>
    </div>

    
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53c591e4471ce379" async="async"></script>

<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/mini-preview.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-58169656-1', 'auto');
ga('send', 'pageview');

(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

  </body>
</html>
