<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Checking your build in SNAP-CI via nodebots using NodeJS and Arduino</title>
  <meta name="description" content="This is my blog, where i talk about technologies" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://willmendesneto.github.io/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino">

  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="cache-control" content="no-store, no-cache, must-revalidate" />
    <meta http-equiv="Pragma" content="no-store, no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE" />
    <meta http-equiv="PRAGMA" content="NO-CACHE" />
    <meta name="domain" content="willmendesneto.github.io" />
    <meta name="url" content="/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino" />

    <meta property="og:type" content="article" />
    <meta property="og:title" content="Checking your build in SNAP-CI via nodebots using NodeJS and Arduino" />
    <meta property="og:url" content="/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino" />
    <meta property="og:description" content="" />
    <meta property="article:author" content="" />
    <meta property="og:site_name" content="Wilson Mendes - Blog" />
    <meta property="og:image" content="http://london.nodebots.io/images/robot.jpg" />
    <meta name="twitter:site" content="@willmendesneto" />
    <meta name="twitter:image" content="http://london.nodebots.io/images/robot.jpg" />
    <meta name="twitter:card" content="summary" />
    <meta name="autor" content="Wilson Mendes" />
    <meta name="reply-to" content="willmendesneto@gmail.com">
    <meta name="revisit-after" content="3" />
    <meta name="title" content="Wilson Mendes - Blog">
    <meta name="description" content="This is my blog, where i talk about technologies">
    <meta name="keywords" content="["frontend",, "nodebots",, "nodejs"]" />
  

  <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Pesquisa no Blog" />

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
<!--  <link rel="stylesheet" href=""> -->
  <!-- <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i"> -->
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800" rel="stylesheet" type="text/css">

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/main.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/solarized-dark.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article" id="body-content">
    <!-- header start -->

<!-- <a href="http://willmendesneto.github.io" class="logo-readium"><span class="logo" style="background-image: url()"></span></a> -->

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="article-image">
          <div class="post-image-image" style="background-image: url(http://london.nodebots.io/images/robot.jpg)">
            Article Image
          </div>
          <div class="post-meta">
            <h1 class="post-title">Checking your build in SNAP-CI via nodebots using NodeJS and Arduino</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(https://pt.gravatar.com/userimage/20307137/677413a79461cdfd62c8a65143214850.png?size=300)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Wilson Mendes</h4>
              on
              <time datetime="2016-05-15 00:00">15 May 2016</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
            <div style="text-align:center">
              <a href="#topofpage" class="topofpage"><i class="fa fa-angle-down"></i></a>
            </div>
          </div>
        </div>
        
        <section class="post-content">

          <a class="home-button"  href="/">&laquo; Home</a>
          <div class="post-reading">
            Lido a <span class="post-reading-time"></span>
          </div>
          <a name="topofpage"></a>
          <div id="post-content-page">
            <p><a class="page-link" href="/2015/10/28/checando-sua-build-pipeline-no-snap-ci-via-nodebots-utilizando-nodejs-e-arduino/">Read the Brazilian Portuguese version</a></p>

<h1 id="intro">Intro</h1>

<p>The idea of this post is share some basic concepts about open hardware usage and management using Javascript.</p>

<p>When we start with the contact with <a href="https://www.arduino.cc/">Arduino</a> for example, the most common example is blink the led. But this time I will show a more atractive approach based in models like Hubot e Retaliation to check our build pipeline and validate our application healthy using <a href="https://www.arduino.cc/">Arduino</a> + NodeJS + <a href="https://johnny-five.io/">Johnny-Five</a> in a <a href="https://nodebots.io/">NodeBots</a> introduction.</p>

<h1 id="build-pipeline">Build pipeline</h1>

<p>In some presentations I realize that this terminology is not common for lots of people, even those most familiar with continous integration or continuous deployment. Build pipeline is a concept created in 2005 based in the task paralelization, splitting each step by small application acceptance criterias. It’s nice to know that these steps can be happening manually or automatically.</p>

<p>An example of freemium service that use this concept by default is <a href="https://snap-ci.com/">Snap-CI</a>, that gives plenty facilities, a good programming languages support, deployment and other cool features.</p>

<p>There’s a github repository example with <a href="https://snap-ci.com/">Snap-CI</a> integration for our build-checker project. After some initial configuraitons (this step is really simple) you can verify our latest build in notifications tab.</p>

<h1 id="nodebots">NodeBots</h1>

<p>Nodebots is a concept based in the union of Javascript and robotic, possible because the advent of NodeJS, that makes the javascript popular beyond the browsers (such as in fridges, microcontrollers, etc) and node-serialport package, created by Chris Williams, enabling hardware control via javascript.</p>

<h1 id="arduino">Arduino</h1>

<p><a href="https://www.arduino.cc/">Arduino</a> is a open-source platform (hardware and software) that is really easy to use. With that one, is anybody is able to make hardware/eletronic interactions in a different ways or do whatever you want.</p>

<p>Some advantages:</p>

<ul>
  <li>Cost: the arduino amount is less than $50;</li>
  <li>Cross-platform: Arduino is a open-source platform, compatible with all existent SO’s;</li>
  <li>Easy: It’s no necessary a bigger eletronic knowledgment. If you have basic ideas and know how to develop a simple code, it’s enought (after the first step you have to learn, of course) and you can do cool things with that one!</li>
</ul>

<p>Based in these characteristics let’s talk about our <a href="https://nodebots.io/">NodeBots</a> introduction project with the <a href="https://github.com/willmendesneto/build-checker">build-checker</a>.</p>

<h1 id="build-checker-the-project">Build checker: the project</h1>

<p>The project was based in CCMenu, a project created by the ThoughtWorker Erik Doernenburg to check and shows the status of a specific projecy in a continous integration server.</p>

<p>In our case let’s use something physic, with open hardware and NodeJS. Our application will consume a XML with some informations responsed by the <a href="https://snap-ci.com/">Snap-CI</a> and we will check the current application status, using Arduino and leds for let us know that something wrong is happening with our build and we have to fix ASAP.</p>

<p>Firstly we need to install NodeJS in our PC/laptop/computational device. For do this you can take a loook in nodejs project website, for example.</p>

<p>The next step is install the Arduino IDE. After installation, try access: <code class="highlighter-rouge">Options &gt; Files &gt; Exaples &gt; StandardFirmata</code>.</p>

<p><img src="/assets/images/open-firmata-example.png" alt="Accessing options tab in Arduino IDE" /></p>

<p>With the arduino plugged in our laptop, we will run this specific code and wait for the IDE display the success message.</p>

<p><img src="/assets/images/upload-firmata-example.png" alt="It's all ok. Firmata running" /></p>

<p>Now is time of our build checker. For do this we will use the <a href="https://johnny-five.io/">Johnny-Five</a> package. The code is really simple.</p>

<noscript><pre>var request = require(&#39;request&#39;);
var five = require(&#39;johnny-five&#39;);
var board = new five.Board();

var CONFIG = {
  LED: {
    SUCCESS: 12,
    ERROR: 10
  },
  CI_CCTRACKER_URL: &#39;https://snap-ci.com/willmendesneto/generator-reactor/branch/master/cctray.xml&#39;,
  INTERVAL: 500
};

function debounce(func, wait, immediate) {
	var timeout;
	return function() {
		var context = this, args = arguments;
		var later = function() {
			timeout = null;
			if (!immediate) func.apply(context, args);
		};
		var callNow = immediate &amp;&amp; !timeout;
		clearTimeout(timeout);
		timeout = setTimeout(later, wait);
		if (callNow) func.apply(context, args);
	};
};

board.on(&#39;ready&#39;, function() {

  var ledSuccess = new five.Led(CONFIG.LED.SUCCESS);
  var ledError = new five.Led(CONFIG.LED.ERROR);

  debounce(function(){
    request(CONFIG.CI_CCTRACKER_URL, function(error, response, body) {
      if (error) {
        console.log(&#39;Somethink is wrong with your CI =(&#39;);
        return;
      }

      if(body.indexOf(&#39;Success&#39;) !== -1) {
        console.log(&#39;Your CI is ok!&#39;);

        ledSuccess.on();
        ledError.off();

      } else {
        console.log(&#39;Somethink is wrong with your CI =(. Fix it!!!!&#39;);

        ledSuccess.off();
        ledError.on();
      }

    });
  }, CONFIG.INTERVAL);

});</pre></noscript>
<script src="https://gist.github.com/willmendesneto/b5f92a932ec3b7ffadd0.js"> </script>

<p>As I said before, you can be really familiar with the Johnny-Five’s interface. It has <code class="highlighter-rouge">board.on('ready')</code> event, for example, that is similar of jQuery <code class="highlighter-rouge">$(document).ready()</code>. With all environment configured, let’s start based in this event, right? We need to plug 2 leds: 1 red (for display when build is broken) and 1 green (for display when the build is fine). We will put the success build in port number 12 + GND (ground) port and use the port number 10 + GND (ground) for display when our build is correct in our arduino as you can take a look in the image.</p>

<p><img src="/assets/images/connecting-arduino-leds.png" alt="Connecting Arduino: ports and LEDS" /></p>

<p>Now we will create the request for consume the content via HTTP GET status in <a href="https://snap-ci.com/">SNAP-CI</a>, our continuous integration service, that uses the build pipeline, a really interesting concept; About the pros, this approach give a fast feedback for the developers (async or sync) and definition of all build based in steps. <a href="http://www.martinfowler.com/articles/continuousIntegration.html">If you like to know more about it, please access this link</a>.</p>

<p>Let’s access SNAP-CI website, do the login (if you don’t have account there, it’s really fast =) ) and add a project.</p>

<p><img src="/assets/images/snap-ci-setup-repo.png" alt="SNAP-CI &quot;Add new repository&quot;" /></p>

<p><img src="/assets/images/snap-ci-choosing-repo.png" alt="Add integration in the new repository" /></p>

<p>When you add the project it will display a field with “CCTray” name that, when clicked, makes a redirect for the XML file with all build informations.</p>

<p><img src="/assets/images/snap-ci-cctray.png" alt="SNAP-CI: CCTray Alert" /></p>

<p>The <code class="highlighter-rouge">.xml</code> will be like that one.</p>

<p><img src="/assets/images/snap-ci-build-xml.png" alt="&quot;cctray.xml&quot; file with all build informations" /></p>

<p>The Build Checker will check the data in a poller of 500 miliseconds, previewed configured and validating the current state of the build pipeline. If the response contains “Success” in the response, something wrong is happening and our build checker will blink the red led, otherwise the green led will be lighter and that’s all fine!</p>

<p>If you like to take a look in the final result, just run the commands</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install <span class="c"># instala todas as dependências do projeto</span>
<span class="gp">$ </span>node index.js <span class="c"># roda o código do build checker</span>
</code></pre>
</div>

<p>And if you like to know more about the project, <a href="https://github.com/willmendesneto/build-checker">visit the github Build-Checker project</a>. The code is open-source, so feel free to give me some feedback, suggestions for constructive feedback (and github stars are always welcome). This project was based in <a href="https://www.youtube.com/watch?v=1EGk2rvZe8A">Relatiation</a> project, by github to validate the Jenkins build status and give some “special feedback” for the team member. Watch this video and take a look how retaliation works.</p>

<p><a href="https://www.youtube.com/watch?v=1EGk2rvZe8A"><img src="http://img.youtube.com/vi/1EGk2rvZe8A/0.jpg" alt="Retaliation" /></a></p>

<h1 id="conclusion">Conclusion</h1>

<p>This project is a quickly NodeBots]<a href="https://nodebots.io/">nodebots</a> introduction, using the most simplest arduino example, that is the blink code (if you are interested, google it for “blink” or access the Arduino examples). This blink example is something totally didatic, but using NodeJS we realized all the power that we have using some concepts combined with the most classic arduino example … and the next steps are yours!</p>

<p>What are you doing using <a href="https://nodebots.io/">NodeBots</a>, Javascript and/or Arduino? Share your experiences!</p>

<p>Links:</p>

<ul>
  <li>Build Checker: <a href="https://github.com/willmendesneto/build-checker">http://github.com/willmendesneto/build-checker</a></li>
  <li>Johnny-Five: <a href="https://johnny-five.io/">http://johnny-five.io/</a></li>
  <li>SNAP-CI: <a href="https://snap-ci.com/">https://snap-ci.com/</a></li>
  <li>Arduino: <a href="https://www.arduino.cc/">https://www.arduino.cc/</a></li>
  <li>NodeBots: <a href="https://nodebots.io/">http://nodebots.io/</a></li>
  <li>Build Pipeline: <a href="http://www.martinfowler.com/articles/continuousIntegration.html">http://www.martinfowler.com/articles/continuousIntegration.html</a></li>
  <li>Retaliation: <a href="https://www.youtube.com/watch?v=1EGk2rvZe8A">https://www.youtube.com/watch?v=1EGk2rvZe8A</a></li>
</ul>


          </div>
        </section>

        
          <section class="newsletter-content">
    <form action="http://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=willmendesneto', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true;" >
        <h3 class="newsletter-title">Receive news by email</h3>
        <p class="newsletter-text">Subscribe to my newsletter to receive notifications of new articles in your e- mail</p>
        <input class="input-newsletter" type="email" name="email" placeholder="email"/>
        <input type="hidden" value="willmendesneto" name="uri"/>
        <input type="hidden" name="loc" value="en_US"/>
        <input class="btn btn-newsletter" type="submit" value="Subscribe" />
    </form>
</section>

        

        <footer class="post-footer">

          <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
  <a class="addthis_button_preferred_1"></a>
  <a class="addthis_button_preferred_2"></a>
  <a class="addthis_button_preferred_3"></a>
  <a class="addthis_button_preferred_4"></a>
  <a class="addthis_button_preferred_5"></a>
</div>


          <!-- <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Checking+your+build+in+SNAP-CI+via+nodebots+using+NodeJS+and+Arduino&amp;url=http://willmendesneto.github.io/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
                <a class="icon-facebook" href="//www.facebook.com/sharer.php?t=Checking+your+build+in+SNAP-CI+via+nodebots+using+NodeJS+and+Arduino&amp;u=http://willmendesneto.github.io/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino"
                  onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                </a>
              
            
              
            
              
                <a class="icon-google-plus" href="https://plus.google.com/share?t=Checking+your+build+in+SNAP-CI+via+nodebots+using+NodeJS+and+Arduino&amp;url=http://willmendesneto.github.io/2016/05/15/checking-your-build-in-snap-ci-via-nodebots-using-nodejs-and-arduino"
                  onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
                <i class="fa fa-google-plus"></i><span class="hidden">google-plus</span>
                </a>
              
            
          </section> -->
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <section class="author">
              <div class="author-image" style="background-image: url(https://pt.gravatar.com/userimage/20307137/677413a79461cdfd62c8a65143214850.png?size=300)">Blog Logo</div>
              <h4>Wilson Mendes</h4>
              
                <p class="bio">Google Developer Expert (GDE) AngularJS and GDG Salvador Organizer. Musician and designer in his spare time.</p>
              
              <hr>
              <p class="published">Publicado em <time datetime="2016-05-15 00:00">15 May 2016</time></p>
            </section>
            <footer class="site-footer">
              <section class="poweredby">Mais um blog feito com <a href="http://jekyllrb.com">Jekyll</a></section>
              <a class="subscribe" href="/feed.xml" target="_blank"> <span class="tooltip"> <i class="fa fa-rss"></i> Assine o feed.</span></a>
            </footer>
          </div>
          
        </div>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'willmendesnetogithubio'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */

        'use strict';

        function load() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

          // Remove o evento
          window.onscroll = function() {};
        }

        window.onscroll = function() {
          if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 2000)) {
            load();
          }
        };
        </script>

        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </article>

    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/background-1.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Wilson Mendes - Blog</h1>
        <h2 class="blog-description">This is my blog, where i talk about technologies</h2>
        <a href="/" class="btn">Back to Home</a>
      </div>
    </div>

    
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53c591e4471ce379" async="async"></script>

<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://hammerjs.github.io/dist/hammer.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-58169656-1', 'auto');
ga('send', 'pageview');

(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    $window.on('scroll', function() {
      var top = $window.scrollTop();

      if (top < 0 || top > 1500) { return; }
      $image
        .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
        .css('opacity', 1-Math.max(top/700, 0));
    });
    $window.trigger('scroll');

    var height = $('.article-image').height();
    $('.post-content').css('padding-top', height + 'px');

    $('a[href*=#]:not([href=#])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
       && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html,body').animate({ scrollTop: target.offset().top }, 500);
          return false;
        }
      }
    });
  });
}(jQuery));
</script>

  </body>
</html>
